import type { MapDefinition } from './types';

// Línea de meta en x ≈ 0. Lado A = x < 0, lado B = x >= 0.
// Solo contamos vuelta si el coche llegó a x < -5 (vino de la curva de vuelta a meta).
const LINE_X = 0;
const MIN_X_BEFORE_LAP = -5;

export const gp1Map: MapDefinition = {
  id: 'gp1',
  name: 'Circuito GP',
  trackPoints: [
    [0, 0],
    [50, 0],
    [100, 0],
    [160, 0],
    [220, 0],
    [280, 0],
    [340, 0],
    [380, 10],
    [410, 30],
    [430, 60],
    [440, 100],
    [435, 140],
    [415, 165],
    [430, 195],
    [450, 215],
    [455, 250],
    [450, 290],
    [435, 320],
    [410, 340],
    [375, 350],
    [340, 340],
    [320, 320],
    [310, 290],
    [320, 260],
    [300, 235],
    [270, 220],
    [240, 235],
    [230, 265],
    [220, 300],
    [200, 340],
    [175, 375],
    [140, 400],
    [100, 415],
    [55, 410],
    [20, 390],
    [-10, 365],
    [5, 335],
    [30, 310],
    [10, 280],
    [-10, 250],
    [-15, 200],
    [-10, 150],
    [-20, 120],
    [-40, 95],
    [-55, 65],
    [-45, 35],
    [-25, 15],
    [-10, 5],
  ],
  roadWidth: 30,
  wallHeight: 3,
  wallThickness: 1.2,
  lap: {
    getSideOfLine: (position) => (position[0] < LINE_X ? 'a' : 'b'),
    isValidLapCrossing: (ctx) =>
      ctx.minX !== null && ctx.minX < MIN_X_BEFORE_LAP,
  },
  spawnPosition: [5, 0.55, 0],
  spawnRotation: [0, -Math.PI / 2, 0],
  totalLaps: 3,
};
